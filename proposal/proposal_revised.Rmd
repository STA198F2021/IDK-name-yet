---
title: "Project Proposal Revised"
subtitle: "due October 20, 2021 by 11:59 PM "
author: "Isabelle Xiong and Maya Ghanem"
date: "10/17/2021"
output: pdf_document
editor_options: 
  chunk_output_type: console
---
# Changes Made:
We chose a Global Health Dataset. We added preliminary visualizations. 

```{r setup, include=FALSE, echo= FALSE, message= FALSE, warning= FALSE}
knitr::opts_chunk$set(echo= TRUE, fig.width = 5,fig.height = 3) 
```

```{r load-data-packages, echo= FALSE, warning= FALSE, message= FALSE}
library(readr)
library(tidyverse)
library(readxl)
library(dplyr)
```

# Load Data

```{r load-data, warning= FALSE, message= FALSE}
X500_cities_diabetes <- read_excel("~/R/Project/data/500_Cities_diabetes.xlsx")
X500_cities_health_insurance <- read_excel("~/R/Project/data/500_cities_health_insurance.xlsx")
X500_cities_heart_diseases <- read_excel("~/R/Project/data/500_cities_heart_diseases.xlsx")
X500_cities_mental_health <- read_excel("~/R/Project/data/500_cities_mental_health.xlsx")
```

```{r rename-select-filter-data, echo= FALSE, warning= FALSE, message= FALSE}
Insurance_CDC_Cities <- X500_cities_health_insurance %>%
  rename(percent_lack_insurance = Data_Value) %>%
  filter(StateDesc %in% c("North Carolin", "South Carolin", "California", "Alabama", "New York", "Ohio")) %>%
  filter(UniqueID %in% c("3702140-37021000100", "3710740-37037020701", "3712000-37119000100", "3714100-37025040500", "3719000-37063000101", "3722920-37051000200", "3725580-37071030802", "3728000-37081010100", "3728080-37147000100", "3731400-37057060101", "3734200-37133000600", "3755000-37063001900", "3774440-37129010100", "3775000-37067000400", "4513330-45019002612", "4516000-45079010804", "4548535-45019004610", "4550875-45035010820", "4561405-45091060102", "0600562-06001428700", "0600884-06037480803", "0602000-06059088402", "0602252-06013313103", "0602364-06071009711", "0685292-06037503402", "0684550-06059099903", "0684200-06037408135", "0682996-06073019206", "0682954-06107002002", "0682590-06071009911", "0107000-01073001902", "0135896-01073014412", "0137000-01089000202", "0150000-01097003703", "0151000-01101005611", "0177256-01125012503", "3651000-36005042300", "3611000-36029000700", "3650617-36119006600", "3601000-36001001801", "3916000-39035123400", "3901000-39153506200", "3918000-39049002750", "3915000-39061005900", "3988000-39099800600", "3977000-39095001301", "3961000-39035177404", "3921000-39113080100", "0606000-06001422900", "0636546-06037601801")) %>%
  select(CityName, percent_lack_insurance)
Mental_Health_CDC_Cities <- X500_cities_mental_health %>%
  rename(percent_mental_health = Data_Value) %>%
  filter(StateDesc %in% c("North Carolin", "South Carolin", "California", "Alabama", "New York", "Ohio")) %>%
  filter(UniqueID %in% c("3702140-37021000100", "3710740-37037020701", "3712000-37119000100", "3714100-37025040500", "3719000-37063000101", "3722920-37051000200", "3725580-37071030802", "3728000-37081010100", "3728080-37147000100", "3731400-37057060101", "3734200-37133000600", "3755000-37063001900", "3774440-37129010100", "3775000-37067000400", "4513330-45019002612", "4516000-45079010804", "4548535-45019004610", "4550875-45035010820", "4561405-45091060102", "0600562-06001428700", "0600884-06037480803", "0602000-06059088402", "0602252-06013313103", "0602364-06071009711", "0685292-06037503402", "0684550-06059099903", "0684200-06037408135", "0682996-06073019206", "0682954-06107002002", "0682590-06071009911", "0107000-01073001902", "0135896-01073014412", "0137000-01089000202", "0150000-01097003703", "0151000-01101005611", "0177256-01125012503", "3651000-36005042300", "3611000-36029000700", "3650617-36119006600", "3601000-36001001801", "3916000-39035123400", "3901000-39153506200", "3918000-39049002750", "3915000-39061005900", "3988000-39099800600", "3977000-39095001301", "3961000-39035177404", "3921000-39113080100", "0606000-06001422900", "0636546-06037601801")) %>%
  select(CityName, percent_mental_health) 
Diabetes_CDC_Cities <- X500_cities_diabetes %>%
  rename(percent_diabetes = Data_Value) %>%
  filter(StateDesc %in% c("North Carolin", "South Carolin", "California", "Alabama", "New York", "Ohio")) %>%
  filter(UniqueID %in% c("3702140-37021000100", "3710740-37037020701", "3712000-37119000100", "3714100-37025040500", "3719000-37063000101", "3722920-37051000200", "3725580-37071030802", "3728000-37081010100", "3728080-37147000100", "3731400-37057060101", "3734200-37133000600", "3755000-37063001900", "3774440-37129010100", "3775000-37067000400", "4513330-45019002612", "4516000-45079010804", "4548535-45019004610", "4550875-45035010820", "4561405-45091060102", "0600562-06001428700", "0600884-06037480803", "0602000-06059088402", "0602252-06013313103", "0602364-06071009711", "0685292-06037503402", "0684550-06059099903", "0684200-06037408135", "0682996-06073019206", "0682954-06107002002", "0682590-06071009911", "0107000-01073001902", "0135896-01073014412", "0137000-01089000202", "0150000-01097003703", "0151000-01101005611", "0177256-01125012503", "3651000-36005042300", "3611000-36029000700", "3650617-36119006600", "3601000-36001001801", "3916000-39035123400", "3901000-39153506200", "3918000-39049002750", "3915000-39061005900", "3988000-39099800600", "3977000-39095001301", "3961000-39035177404", "3921000-39113080100", "0606000-06001422900", "0636546-06037601801")) %>%
  select(CityName, percent_diabetes) 
Heart_Disease_CDC_Cities <- X500_cities_heart_diseases %>%
  rename(percent_heart_disease = Data_Value) %>%
  filter(StateDesc %in% c("North Carolin", "South Carolin", "California", "Alabama", "New York", "Ohio")) %>%
  filter(UniqueID %in% c("3702140-37021000100", "3710740-37037020701", "3712000-37119000100", "3714100-37025040500", "3719000-37063000101", "3722920-37051000200", "3725580-37071030802", "3728000-37081010100", "3728080-37147000100", "3731400-37057060101", "3734200-37133000600", "3755000-37063001900", "3774440-37129010100", "3775000-37067000400", "4513330-45019002612", "4516000-45079010804", "4548535-45019004610", "4550875-45035010820", "4561405-45091060102", "0600562-06001428700", "0600884-06037480803", "0602000-06059088402", "0602252-06013313103", "0602364-06071009711", "0685292-06037503402", "0684550-06059099903", "0684200-06037408135", "0682996-06073019206", "0682954-06107002002", "0682590-06071009911", "0107000-01073001902", "0135896-01073014412", "0137000-01089000202", "0150000-01097003703", "0151000-01101005611", "0177256-01125012503", "3651000-36005042300", "3611000-36029000700", "3650617-36119006600", "3601000-36001001801", "3916000-39035123400", "3901000-39153506200", "3918000-39049002750", "3915000-39061005900", "3988000-39099800600", "3977000-39095001301", "3961000-39035177404", "3921000-39113080100", "0606000-06001422900", "0636546-06037601801")) %>%
  select(StateDesc, CityName, GeoLocation, UniqueID, percent_heart_disease)
```


```{r join-data, echo= FALSE, message= FALSE, warning= FALSE}
left_join_1 <- Mental_Health_CDC_Cities %>%
  left_join(Insurance_CDC_Cities)
```

```{r join-data-2, echo= FALSE, message= FALSE, warning= FALSE}
left_join_2 <- left_join_1 %>%
  left_join(Diabetes_CDC_Cities)
```

```{r join-data-3, echo= FALSE, message= FALSE, warning= FALSE}
final_CDC_data <- left_join_2 %>%
  left_join(Heart_Disease_CDC_Cities)
```

# Introduction and Data, including Research Questions

The 500 cities dataset is provided by the Center for Disease Control and Prevention (CDC), Division of Population Health, Epidemiology and Surveillance Branch. Data from this dataset is sourced from 28,000 census tracts in “Census Bureau 2010 census population data, Behavioral Risk Factor Surveillance System (BRFSS) data (2017, 2016), and American Community Survey (ACS) 2013-2017, 2012-2016 estimates”. All data was collected through the form of surveys. The metadataset features data for a total of 5 “unhealthy behaviors”, 13 “health outcomes'' and 9 “preventive services” related to 27 types of chronic disease in 500 largest cities in the US. Within the datasets for diabetes, coronary heart disease, mental health outcomes and health insurance, variables include city, state, state abbreviation, year, datasource, TractFIPS, CityFIPS, Geographic Level, data value, low confidence unit, high confidence unit, coordinate of geographical location of city. 

America, unlike other developed countries, does not have a universal healthcare program, meaning that not all individuals are granted free health insurance by the government. In America, Health insurance is purchased in the private marketplace or provided by the government only to certain groups, such as pregnant, low income, elderly, families with children. Having lived in Canada, where all citizens can apply for a public health insurance for free which grants them access to quality healthcare, I’ve never had to think of what it would be like without access to healthcare. In doing this research, I wanted to understand the effects of a lack of health insurance in the US, by finding the correlation between not having health insurance and the likelihood of contracting different diseases in 500 largest US cities.

## Research Question:

Do cities with higher percentages of uninsured people have poorer mental health outcomes, higher rates of diabetes, and higher rates of heart disease?

# Glimpse

We selected 50 cities from the original CDC dataset as our sample.

```{r glimpse-dataset, warning= FALSE, message= FALSE}
glimpse(final_CDC_data)
```

# Data Analysis Plan

## Explanatory and Response Variables

Explanatory Variable: percentage of uninsured people in each city

Response Variable: percentage of people in each city who reported poor mental health for more than two weeks in 2017, percentage of people in each city diagnosed with diabetes, percentage of people in each city with coronary heart disease

## Initial Visualizations

```{r insurance-mentalhealth, echo= FALSE, warning= FALSE, message= FALSE}
final_CDC_data %>%
ggplot(mapping = aes(x = percent_lack_insurance, y = percent_mental_health)) +
  geom_point() +
  labs(
    title = "Lack of Health Insurance and Mental Health Outcomes",
    subtitle = "Population % from 50 cities in 2017 CDC '500 Cities' Data",
    x = "Lack of Insurance (%)",
    y =  "Reporting 2+ Weeks Poor Mental Health
in 2017 (%)"
  )
```

```{r insurance-diabetes, echo= FALSE, warning= FALSE, message= FALSE}
final_CDC_data %>%
ggplot(mapping = aes(x = percent_lack_insurance, y = percent_diabetes)) +
  geom_point() +
  labs(
    title = "Lack of Health Insurance and Diabetes Prevalence",
    subtitle = "Population % from 50 cities in 2017 CDC '500 Cities' Data",
    x = "City Pop without Insurance (%)",
    y = "Population with Diabetes (%)"
  )
```

```{r insurance-heartdisease, echo= FALSE, warning= FALSE, message= FALSE}
final_CDC_data %>%
ggplot(mapping = aes(x = percent_lack_insurance, y = percent_heart_disease)) +
  geom_point() +
  labs(
    title = "Lack of Health Insurance and Heart Disease Prevalence",
    subtitle = "Population % from 50 cities in 2017 CDC '500 Cities' Data",
    x = "Lack of Insurance (%)",
    y = "Population with Heart Disease (%)"
  )
```

Based on the visuals above, the strongest correlation seems to be between Lack of Health Insurance and Mental Health Outcomes. All three graphs depict positive correlations. There is large spread and variation in the data for all visuals.

## Statistical Tests

We will first run three t-tests to determine if there is any significance in the relationship between the percentage of uninsured people and prevalence of poor mental health outcomes, diabetes, and heart disease (respectively). We will then run three regression models to further understand the association between the explanatory variable and each response variable. Through the regression model, we hope to quantify the relationship between the percentage of uninsured people and prevalence of poor mental health outcomes, diabetes, and heart disease. We will also determine the significance of the regression by understanding the t-statistics of the coefficients in each regression.

# References

https://chronicdata.cdc.gov/500-Cities-Places/500-Cities-Local-Data-for-Better-Health-2019-relea/6vp6-wxuq